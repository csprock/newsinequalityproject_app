<!DOCTYPE html>
<html lang = "en">
<head>
<title> Coverage Map </title>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>


<style>

	body {font-style: helvetica}
	
	circle:hover {opacity:0.1}
	
	div.tooltip {	
    position: absolute;
	font-size: 150%;
    text-align: left;							
    padding: 8px;				
    font: 12px sans-serif;		
    background: #F4F6F7;	
    border: 0px;		
    border-radius: 8px;			
    pointer-events: none;	}
	
	.legend { font-family: helvetica}
	
</style>



<script>
var add_table = function(d2){

		var theTable = document.getElementById("theTable");
		var theTitle = document.getElementById("heading");
		var heading = document.createTextNode("Neighborhood: " + d2.cd_name);
		theTitle.appendChild(heading);
		
		<!-- first row -->
		var row1 = theTable.insertRow(0)
		var cell1 = row1.insertCell(0)
		var cell2 = row1.insertCell(1)
		var temp1 = document.createTextNode("Articles about Gentrification:")
		cell1.append(temp1)
		var temp2 = document.createTextNode(d2.articles)
		cell2.append(temp2)
		<!-- second row -->
		var row2 = theTable.insertRow(1)
		var cell1 = row2.insertCell(0)
		var cell2 = row2.insertCell(1)
		var temp1 = document.createTextNode("% change in rent:")
		var temp2 = document.createTextNode( Math.round(100*d2.rentChange) + "%")
		cell1.append(temp1)
		cell2.append(temp2)

}



</script>
</head>



<body>
<svg class = "chart"></svg>
<script>
var margin = {top:20, right: 30, bottom:20, left:30}, width = 800 - margin.left - margin.right, height = 500 - margin.top - margin.bottom;

<!-- define line parameters -->
var x1 = 0, y1 = -8.046, x2 = 1, y2 = 35.255;

var div = d3.select("body").append("div")	
    .attr("class", "tooltip")				
    .style("opacity", 0);


var x = d3.scaleLinear().range([0, width]);
var y = d3.scaleLinear().range([height, 0])


var xAxis = d3.axisBottom(x);
var yAxis = d3.axisLeft(y);


var chart = d3.select(".chart")
	.attr("width", width + margin.left + margin.right)
	.attr("height", height + margin.top + margin.bottom)
	.append("g")
	.attr("class", "container")
	.attr("transform", "translate(" + margin.left + "," + margin.top + ")");


	
var color = d3.scaleOrdinal(d3.schemeCategory10);


d3.csv("rent_scatter.csv", function(data){

	the_data = data
	
	x.domain([0.1,1]);
	y.domain([0,40]);
	
	chart.selectAll(".dot")
		.data(data)
		.enter()
		.append("circle")
		.attr("class","dot")
		.attr("r", 8)
		.style("opacity", 0.9)
		.attr("cx", function(d){ return x(d.rentChange);})
		.attr("cy", function(d){ return y(d.articles);})
		.style("fill", function(d) {return color(d.c)})
		.on("mouseover", function(d) {
			/. add tooltip ./
			div.transition().duration(600).style("opacity", 0.8);
			div.attr("id", "tooltip")
			div.attr("class","tooltip")
			div.html(
			"<p id = 'heading' style = 'font-size: 125%'> </p>" + 
			"<p id = 'total_articles' style = 'font-size: 125%' > </p>" + 
			"<hr>" + 
			"<table style = 'font-size: 125%' id = 'theTable'> </table>")
				.style("left", (d3.event.pageX) + "px")		
                .style("top", (d3.event.pageY ) + "px")
				.attr("id", "tooltip");
			/. add table ./
			add_table(d);
		})
		.on("mouseout", function(d) {
			div.transition().duration(300).style("opacity", 0);
		});

	
	chart.append("line")
		.attr("class", "line")
		.attr("x1", x(x1))
		.attr("y1", y(y1))
		.attr("x2", x(x2))
		.attr("y2", y(y2))
		.attr("style", "stroke:blue ;stroke-width:2")
		.style("opacity", 0.25);
	
	chart.append("g")
		.attr("class", "xaxis")
		.attr("transform", "translate(0," + height + ")")
		.call(xAxis);
		
	chart.append("g")
		.attr("class", "yaxis")
		.call(yAxis);

	var legend = chart.selectAll(".legend")
		.data(color.domain())
		.enter()
		.append("g")
		.attr("class", "legend")
		.attr("transform", function(d,i){ return "translate(0," + i*20 + ")" ;} );
		
	legend.append("rect")
		.attr("x", 10)
		.attr("width", 18)
		.attr("height", 18)
		.style("fill", color);
		
	var names = ["a","b","c","d"];
	
	
	legend.append("text")
		.attr("x", 30)
		.attr("y", 15)
		.text(function(d) { return d});
});









</script>





</body>